---
title: CGI
layout: detail
description: Java cgi
category: [扩展知识,cgi]
tags: [java,cgi]
---
# 什么是CGI
>CGI(Common Gateway Interface)是HTTP服务器与你的或其它客户机 
上的程序进行联系的一种工具，其程序须运行在网络服务器上。是公共网关接口


# 网页浏览

>为了更好的了解CGI是如何工作的，我们可以从在网页上点击一个链接或URL的流程：

1. 使用你的浏览器访问URL并连接到HTTP web 服务器。
2. Web服务器接收到请求信息后会解析URL，并查找访问的文件在服务器上是否存在，如果存在返回文件的内容，否则返回错误信息。
3. 浏览器从服务器上接收信息，并显示接收的文件或者错误信息。

  CGI程序可以是Python脚本，PERL脚本，SHELL脚本，C或者C++程序等。

# CGI 架构图

<div class="col-xs-12">
<img  src='http://www.runoob.com/wp-content/uploads/2013/11/cgiarch1.gif' class='col-lg-offset-3 col-lg-6 col-xs-12 thumbnail'/>
</div>

# Web服务器支持及配置

在你进行CGI编程前，确保您的Web服务器支持CGI及已经配置了CGI的处理程序。
Tomcat7.0  支持CGI 配置：
设置好CGI目录：
>tomcat/conf/web.xml

>     <servlet>
        <servlet-name>cgi</servlet-name>
        <servlet-class>org.apache.catalina.servlets.CGIServlet</servlet-class>
        <init-param>
          <param-name>debug</param-name>
          <param-value>0</param-value>
        </init-param>
        <init-param>
          <param-name>cgiPathPrefix</param-name>
          <param-value>/cgi-bin</param-value>
        </init-param>
         <load-on-startup>5</load-on-startup>
    </servlet>
 
所有的HTTP服务器执行CGI程序都保存在一个预先配置的目录。这个目录被称为CGI目录,在你所需要的项目下面建一个这样的目录`cgi-bin`

```
  ▾ examples/
    ▸ cgi-bin/
    ▸ jsp/
    ▸ servlets/
    ▸ WEB-INF/
    ▸ websocket/
      index.html 

```
另外注意要支持cgi格式 ，否则打开脚本连接时只会提示你下载文件，而不会执行程序

> 
    <servlet-mapping>
        <servlet-name>cgi</servlet-name>
        <url-pattern>/cgi-bin/*</url-pattern>
    </servlet-mapping>


注意context.xml的下面的配置：

<Context privileged="true"> 
    <WatchedResource>WEB-INF/web.xml</WatchedResource>
    <WatchedResource>${catalina.base}/conf/web.xml</WatchedResource>
</Context>

其中 `privileged` 设置为true,否则会报 `404`

到此，我们的准备工作已经OK


# HelloWorld

> CGI文件的扩展名为.cgi

`helloworld.cgi`

```

    #!/bin/sh
    
    echo "Content-type: text/html"
    echo
    echo "<HTML><HEAD>"
    echo "<TITLE>helloworld</TITLE>"
    echo "</HEAD><BODY>"
    echo "HELLOWORLD,current time:"
    date +%Y-%m-%d
    echo "</BODY></HTML>"

```
访问路径：

>http://localhost:8080/examples/cgi-bin/helloworld.cgi

页面显示结果：

> HELLOWORLD,current time: 2016-01-09 

<hr>

#参考
> <http://www.runoob.com/python/python-cgi.html>
